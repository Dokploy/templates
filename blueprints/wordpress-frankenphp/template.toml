[variables]
main_domain = "${domain}"
db_name = "wordpress_franken"
db_password = "${password:32}"
cache_purge_key = "${password:16}"

SOLUTION B - Port fixe (si Domain ne marche pas)
[[config.ports]]
serviceName = "wordpress"  
hostPort = 8080
containerPort = 80
protocol = "http"

[config]
env = [
  # Database Configuration
  'DB_NAME=${db_name}',
  'DB_USER=wordpress',
  'DB_PASSWORD=${db_password}',
  'DB_HOST=wp_db',
  'DB_TABLE_PREFIX=wp_',
  
  # WordPress URLs - CRUCIAL !
  'WORDPRESS_CONFIG_EXTRA=define("WP_HOME", "http://${main_domain}"); define("WP_SITEURL", "http://${main_domain}"); define("WP_DEBUG", false); define("WP_CACHE", true);',
  
  # FrankenPHP Config
  'SERVER_NAME=:80',
  'CADDY_GLOBAL_OPTIONS=auto_https off',
  'FRANKENPHP_CONFIG=num_threads 100',
  
  # MariaDB Config  
  'MARIADB_ROOT_PASSWORD=${db_password}',
  'MARIADB_DATABASE=${db_name}',
  'MARIADB_USER=wordpress',
  'MARIADB_PASSWORD=${db_password}',
]

[[config.mounts]]
filePath = "uploads.ini"
content = """
upload_max_filesize = 128M
post_max_size = 128M
memory_limit = 512M
max_execution_time = 300
opcache.enable=1
opcache.memory_consumption=256M
"""
