[variables]
main_domain = "${domain}"
db_name = "wordpress_franken"
db_password = "${password:32}"
cache_purge_key = "${password:16}"

# PORT DIRECT - Bypass Traefik
[[config.ports]]
serviceName = "wordpress"
hostPort = 8080
containerPort = 80
protocol = "http"

[config]
# RÉSEAU ISOLÉ
networks = ["dokploy_internal"]

# LABELS ANTI-TRAEFIK
labels = {
  "traefik.enable" = "false",
  "traefik.docker.network" = "none"
}

env = [
  # Database
  'DB_NAME=${db_name}',
  'DB_USER=wordpress',
  'DB_PASSWORD=${db_password}',
  'DB_HOST=wp_db',
  
  # WordPress Config
  'WORDPRESS_CONFIG_EXTRA=define("WP_HOME", "http://${main_domain}:8080"); define("WP_SITEURL", "http://${main_domain}:8080");',
  
  # FrankenPHP
  'SERVER_NAME=:80',
  'CADDY_GLOBAL_OPTIONS=auto_https off',
  
  # ANTI-TRAEFIK FORCÉ
  'TRAEFIK_ENABLE=false',
  'traefik.enable=false',
  
  # MariaDB
  'MARIADB_ROOT_PASSWORD=${db_password}',
  'MARIADB_DATABASE=${db_name}',
  'MARIADB_USER=wordpress',
  'MARIADB_PASSWORD=${db_password}',
]
