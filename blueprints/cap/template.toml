[variables]
main_domain = "${domain}"
database_encryption_key = "${password:32}"
nextauth_secret = "${password:32}"
minio_root_user = "${username}"
minio_root_password = "${password:32}"
aws_access_key = "${username}"
aws_secret_key = "${password:32}"

[config]
[[config.domains]]
serviceName = "cap-web"
port = 3000
host = "${main_domain}"
path = "/"

[[config.domains]]
serviceName = "minio"
port = 3903
host = "minio.${main_domain}"
path = "/console"

[config.env]
# cap-web environment variables
DATABASE_URL = "mysql://root:@ps-mysql:3306/planetscale?ssl={\"rejectUnauthorized\":false}"
WEB_URL = "http://${main_domain}:3000"
NEXTAUTH_URL = "http://${main_domain}:3000"
DATABASE_ENCRYPTION_KEY = "${database_encryption_key}"
NEXTAUTH_SECRET = "${nextauth_secret}"
CAP_AWS_ACCESS_KEY = "${aws_access_key}"
CAP_AWS_SECRET_KEY = "${aws_secret_key}"
CAP_AWS_BUCKET = "capso"
CAP_AWS_REGION = "us-east-1"
S3_PUBLIC_ENDPOINT = "http://${main_domain}:3902"
S3_INTERNAL_ENDPOINT = "http://minio:3902"

# ps-mysql environment variables
MYSQL_DATABASE = "planetscale"
MYSQL_ROOT_HOST = "%"
MYSQL_ALLOW_EMPTY_PASSWORD = "yes"

# minio environment variables
MINIO_API_PORT_NUMBER = "3902"
MINIO_CONSOLE_PORT_NUMBER = "3903"
MINIO_ROOT_USER = "${minio_root_user}"
MINIO_ROOT_PASSWORD = "${minio_root_password}"

[[config.mounts]]