[variables]
  # These define the UI fields in Dokploy
  NEXTCLOUD_DOMAIN = "${domain}"
  DB_PASSWORD = "${password:32}"
  DB_ROOT_PASSWORD = "${password:32}"
  PHONE_REGION = "DE"

[config]
  [[config.domains]]
    serviceName = "nextcloud"
    port = 80
    host = "${NEXTCLOUD_DOMAIN}"

  [[config.env]]
    serviceName = "nextcloud"
    env = [
      "NEXTCLOUD_DOMAIN=${NEXTCLOUD_DOMAIN}",
      "MYSQL_SECRET_PASSWORD=${DB_PASSWORD}",
      "DEFAULT_PHONE_REGION=${PHONE_REGION}",
      "OVERWRITEPROTOCOL=https",
      "TRUSTED_PROXIES=10.0.0.0/8 172.16.0.0/12",
      "REDIS_HOST=nextcloud_redis"
    ]

  [[config.env]]
    serviceName = "nextcloud_db"
    env = [
      "MYSQL_PASSWORD=${DB_PASSWORD}",      # Matches the app's password
      "MYSQL_ROOT_PASSWORD=${DB_ROOT_PASSWORD}"
    ]