[variables]
main_domain = "${domain}"

[config]
env = []

[[config.domains]]
serviceName = "prometheus"
port = 9_090
host = "${main_domain}"

[[config.mounts]]
filePath = "/etc/prometheus/prometheus.yml"
serviceName = "prometheus"
content = """
# Prometheus Configuration
# https://prometheus.io/docs/prometheus/latest/configuration/configuration/

global:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    monitor: 'dokploy-prometheus'

# Alertmanager configuration (optional)
# alerting:
#   alertmanagers:
#     - static_configs:
#         - targets:
#           - 'alertmanager:9093'

# Load rules once and periodically evaluate them
# rule_files:
#   - "alerts.yml"

# Scrape configurations
scrape_configs:
  # Prometheus self-monitoring
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  # Example: Add your own targets here
  # - job_name: 'node_exporter'
  #   static_configs:
  #     - targets: ['node-exporter:9100']
  
  # - job_name: 'docker'
  #   static_configs:
  #     - targets: ['docker-host:9323']
"""

